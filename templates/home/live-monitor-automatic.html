{% extends "layouts/base.html" %}

{% block title %} 自动直播监测 {% endblock %} 

<!-- Element injected in the BODY element -->
{% block body_class %} {% endblock body_class %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/static/assets/plugins/fontawesome-free/css/all.min.css">
  <!-- Ekko Lightbox -->
  <link rel="stylesheet" href="/static/assets/plugins/ekko-lightbox/ekko-lightbox.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="/static/assets/css/adminlte.min.css">

  <style>
    .details-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      width: 1200px;
      height: 600px;
      transform: translate(-50%, -50%);
      background-color: white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
    .addtask-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      width: 1000px;
      height: 300px;
      transform: translate(-50%, -50%);
      background-color: white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
  </style>
{% endblock stylesheets %}

{% block content %}

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>自动直播监测</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">主页</a></li>
              <li class="breadcrumb-item active">自动直播监测</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <div class="card card-primary">
              <div class="card-header">
                <h4 class="card-title">监测任务队列</h4>
              </div>
              <div class="card-body">
                <table id="jiancerenwuduilie" class="table table-bordered table-striped">
                  <thead>
                    <tr>
                      <th>直播名称</th>
                      <th>直播间链接</th>
                      <th>当前直播状态</th>
                      <th>当前监测状态</th>
                      <th>操作选项</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>VC官方旗舰店</td>
                      <td>
                        <a href="https://live.douyin.com/815349576986" target="_blank">https://live.douyin.com/815349576986</a>
                      </td>
                      <td>停止直播</td>
                      <td>停止监测</td>
                      <td>
                        <input type="button" class="btn btn-default" onclick=showDetails() value="查看详情">
                        <input type="button" class="btn btn-primary" onclick="" value="开始监测">
                        <input type="button" class="btn btn-warning" onclick="" value="停止监测">
                        <input type="button" class="btn btn-danger" onclick="" value="删除">
                      </td>
                    </tr>
                    <tr>
                      <td>VD官方旗舰店</td>
                      <td>
                        <a href="https://live.douyin.com/815349576986" target="_blank">https://live.douyin.com/815349576986</a>
                      </td>
                      <td>停止直播</td>
                      <td>停止监测</td>
                      <td>
                        <input type="button" class="btn btn-default" onclick=showDetails() value="查看详情">
                        <input type="button" class="btn btn-primary" onclick="" value="开始监测">
                        <input type="button" class="btn btn-warning" onclick="" value="停止监测">
                        <input type="button" class="btn btn-danger" onclick="" value="删除">
                      </td>
                    </tr>
                    <tr>
                      <td>VB官方旗舰店</td>
                      <td>
                        <a href="https://live.douyin.com/815349576986" target="_blank">https://live.douyin.com/815349576986</a>
                      </td>
                      <td>停止直播</td>
                      <td>停止监测</td>
                      <td>
                        <input type="button" class="btn btn-default" onclick=showDetails() value="查看详情">
                        <input type="button" class="btn btn-primary" onclick="" value="开始监测">
                        <input type="button" class="btn btn-warning" onclick="" value="停止监测">
                        <input type="button" class="btn btn-danger" onclick="" value="删除">
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <input type="button" class="btn btn-primary" onclick=showAddNewTaskByKeyword() value="通过关键词批量新增监控任务">
            <input type="button" class="btn btn-primary" onclick=showAddNewTaskByURL() value="通过指定链接新增监控任务">

            <div id="detailpopup" class="details-popup">
              <div class="card card-primary">
                <div class="card-header">
                  <h4 class="card-title">当前监测任务</h4>
                  <span class="close-button" onclick="closeDetails()" style="float: right;  cursor: pointer;">关闭</span>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-sm-6">
                          <!-- <img class="img-fluid" src="/static/assets/img/baiyunshan.png" alt="Photo"> -->
                          <video id="live_video" width="500" height="500" controls loop autoplay muted>
                            <source id="live_video_src" src="" type="video/mp4">
                          </video>
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-6">
                          <div class="row">
                            <div class="col-12 callout callout-info">
                                <h5>语音分析</h5>
                                <p id="asr_result">example asr analysis.</p>
                              </div>
                          </div>
                          <!-- /.row -->
                          <div class="row">
                            <div class="col-12 callout callout-info">
                                <h5>图像识别</h5>
                                <p id="ocr_result">example ocr analysis.</p>
                              </div>
                          </div>
                          <!-- /.row -->
                          <div class="row">
                            <div class="col-12 callout callout-info">
                                <h5>分析结果</h5>
                                <p id="analysis">example analysis result.</p>
                              </div>
                          </div>
                          <!-- /.row -->
                        </div>
                        <!-- /.col -->
                      </div>
                      <!-- /.row -->
                </div>
              </div>
            </div>

            <div id="AddNewTaskByKeyword" class="addtask-popup">
              <div class="card card-warning">
                <div class="card-header">
                  <h3 class="card-title">检索含有目标关键词的直播，并加入到直播监测队列中</h3>
                  <span class="close-button" onclick="closeAddNewTaskByKeyword()" style="float: right;  cursor: pointer;">关闭</span>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
  
                  <form>
                    <!-- input states -->
                    <div class="form-group">
                      <label class="col-form-label" for="inputSuccess"> 输入类型关键词 </label>
                      <input type="text" class="form-control" id="inputSuccess" placeholder="输入 ...">
                    </div>
                          
                    <div class="row">
                      <div class="col-sm-6">
                        <!-- select -->
                        <div class="form-group">
                          <label>选择平台</label>
                          <select class="form-control">
                            <option>抖音</option>
                            <option>淘宝</option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-offset-2 col-sm-10">
                      <input type="button" class="btn btn-default" onclick="sendLiveInfo()" value="搜索并加入监测">
                    </div>
                  </form>
                </div>
                <!-- /.card-body -->
              </div>
            </div>

            <div id="AddNewTaskByURL" class="addtask-popup">
              <div class="card card-warning">
                <div class="card-header">
                  <h3 class="card-title">将链接对应的直播加入到直播监测队列中</h3>
                  <span class="close-button" onclick="closeAddNewTaskByURL()" style="float: right;  cursor: pointer;">关闭</span>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
  
                  <form>
                    <!-- input states -->
                    <div class="form-group">
                      <label class="col-form-label" for="inputSuccess"> 输入链接 </label>
                      <input type="text" class="form-control" id="inputSuccess" placeholder="输入 ...">
                    </div>
                          
                    <div class="row">
                      <div class="col-sm-6">
                        <!-- select -->
                        <div class="form-group">
                          <label>选择平台</label>
                          <select class="form-control">
                            <option>抖音</option>
                            <option>淘宝</option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-offset-2 col-sm-10">
                      <input type="button" class="btn btn-default" onclick="sendLiveInfo()" value="搜索并加入监测">
                    </div>
                  </form>
                </div>
                <!-- /.card-body -->
              </div>
            </div>


          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

  <!-- jQuery -->
  <script src="/static/assets/plugins/jquery/jquery.min.js"></script>
  <!-- Bootstrap -->
  <script src="/static/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- jQuery UI -->
  <script src="/static/assets/plugins/jquery-ui/jquery-ui.min.js"></script>
  <!-- Ekko Lightbox -->
  <script src="/static/assets/plugins/ekko-lightbox/ekko-lightbox.min.js"></script>
  <!-- AdminLTE App -->
  <script src="/static/assets/js/adminlte.min.js"></script>
  <!-- AdminLTE for demo purposes -->
  <script src="/static/assets/js/demo.js"></script>
  <!-- Filterizr-->
  <script src="/static/assets/plugins/filterizr/jquery.filterizr.min.js"></script>

  <!-- DataTables -->
  <script src="/static/assets/plugins/datatables/jquery.dataTables.min.js"></script>
  <script src="/static/assets/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
  <script src="/static/assets/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
  <script src="/static/assets/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>

  <script>
    $(function () {
      $("#jiancerenwuduilie").DataTable({
        "responsive": true,
        "autoWidth": false,
        "paging": false,
      });
    });
  </script>

  <script>
    function showDetails() {
      document.getElementById("detailpopup").style.display = "block";
    }
    function closeDetails() {
      document.getElementById("detailpopup").style.display = "none";
    }

    function showAddNewTaskByKeyword() {
      document.getElementById("AddNewTaskByKeyword").style.display = "block";
    }
    function closeAddNewTaskByKeyword() {
      document.getElementById("AddNewTaskByKeyword").style.display = "none";
    }
    function showAddNewTaskByURL() {
      document.getElementById("AddNewTaskByURL").style.display = "block";
    }
    function closeAddNewTaskByURL() {
      document.getElementById("AddNewTaskByURL").style.display = "none";
    }

  </script>
{% endblock javascripts %}
